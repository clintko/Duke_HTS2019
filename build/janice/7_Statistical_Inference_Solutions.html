

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Estimation and Hypothesis Testing &mdash; HTS2019 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with Unix" href="../cliburn/Unix01_File_And_Directory_Solutions.html" />
    <link rel="prev" title="Simulations and Statistical Inference" href="6_Statistical_Inference.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> HTS2019
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Slides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../slides.html">Slide sets</a></li>
</ul>
<p class="caption"><span class="caption-text">Quick Intro of Analysis Tools</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_IntroToCompBoot.html">Duke HTS Summer Course 2018</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_Intro_to_Unix_and_bash.html">Introduction to Unix and bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_IntroductionToR.html">Introduction to R</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_Rlibraries_and_bioconductor.html">R libraries and Bioconductor</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_Tidyverse_HandsOn-Filled.html">Hands-On Tidyverse - with count data</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Statistical_Inference.html">Simulations and Statistical Inference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Estimation and Hypothesis Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Set-random-number-seed-for-reproucibility">Set random number seed for reproucibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Functions-around-probability-distributions">Functions around probability distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Point-estimates">Point estimates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Mean">Mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Median">Median</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Quantiles">Quantiles</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Interval-estimates">Interval estimates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Confidence-intervals">Confidence intervals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Making-a-function">Making a function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Review-of-R-custom-functions">Review of R custom functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Coverage">Coverage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Hypothesis-testing">Hypothesis testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Binomial-test">Binomial test</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#What-happens-if-we-choose-a-one-sided-test?">What happens if we choose a one-sided test?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#What-happens-if-we-change-our-null-hypothesis?">What happens if we change our null hypothesis?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Two-sample-model">Two-sample model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Welch-t-test">Welch t-test</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Standard-t-test">Standard t-test</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Power-of-t-test">Power of t-test</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Interpretation-of-the-power-calculaiton">Interpretation of the power calculaiton</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Distribution-of-p-values-under-the-null-is-uniform">Distribution of p-values under the null is uniform</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Paired-and-one-sample-t-tests">Paired and one-sample t-tests</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Unix Shell</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/Unix01_File_And_Directory_Solutions.html">Working with Unix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/Unix02_FileIO_Solutions.html">File I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/Unix03_File_Storage_Solutions.html">File archival and recovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/Unix04_Text_Manipulation_Solutinos.html">Working with text</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/Unix05_Variables_Solutions.html">Unix Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/Unix06_Bash_Bioinformatics.html">Using <code class="docutils literal notranslate"><span class="pre">bash</span></code> in bioinformatics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/Unix07_Capstone_Exercise.html">Unix capstone exercise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/Unix07_Capstone_Exercise_Solutions.html">Unix capstone exercise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/Unix_Appendix01_Regular_Expressions.html">The Unix Shell: Regular Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/Unix_Appendix02_Review.html">Unix Review of Basics</a></li>
</ul>
<p class="caption"><span class="caption-text">R Graphics and Data Manipulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R00_Review_Basics.html">Basics of R (Review)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R00_Review_Basics.html">Basics of R (Review)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R01_Data_Manipulation_Solutions.html">Data Manipulation in the <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R02_Tidying_Data_Solutions.html">Tidy Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R03_FileIO.html">File I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R04_Unsupervised_Learning.html">Unsupervised Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R05_Unsupervised_Learning_More_Examples.html">Unsupervised Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R06_Graphics_Overview.html">R Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R07_Graphics_Base.html">R Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R08_Graphics_ggplot2.html">R Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R09_Graphics_Exercise.html">R Graphics Exercise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliburn/R09_Graphics_Exercise_Solutions.html">R Graphics Exercise (Solutions)</a></li>
</ul>
<p class="caption"><span class="caption-text">Analysis of Pilot Data (Gene Count, DESeq2 &amp; DE Analysis)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DESeq2/8_Pilot2019_getstarcounts-KO.html">Get Star Count of the Pilot 2019 Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DESeq2/00_deseq_prepare_data.html">DESeq2: Create count matrix and metadata data frame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DESeq2/01_deseq_dataobject.html">DESeq2: Create Data Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DESeq2/02_deseq_DE.html">DESeq2: Basic Differential Expression (DE) analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DESeq2/03_deseq_interaction.html">DESeq2: Basic Differential Expression (DE) analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DESeq2/04-deseq2-plots.html">Generate figures from DESEq2 analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Reproducible Analysis (Git)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../computing/data_handling_demo.html">Data handling Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computing/git_lesson.html">Git Lesson</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computing/git_in_class.html">Git in class</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HTS2019</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Estimation and Hypothesis Testing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/janice/7_Statistical_Inference_Solutions.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Estimation-and-Hypothesis-Testing">
<h1>Estimation and Hypothesis Testing<a class="headerlink" href="#Estimation-and-Hypothesis-Testing" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kn">library</span><span class="p">(</span>tidyverse<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Registered S3 methods overwritten by &#39;ggplot2&#39;:
  method         from
  [.quosures     rlang
  c.quosures     rlang
  print.quosures rlang
── <span class="ansi-bold">Attaching packages</span> ─────────────────────────────────────── tidyverse 1.2.1 ──
<span class="ansi-green-fg">✔</span> <span class="ansi-blue-fg">ggplot2</span> 3.1.1     <span class="ansi-green-fg">✔</span> <span class="ansi-blue-fg">purrr  </span> 0.3.2
<span class="ansi-green-fg">✔</span> <span class="ansi-blue-fg">tibble </span> 2.1.2     <span class="ansi-green-fg">✔</span> <span class="ansi-blue-fg">dplyr  </span> 0.8.1
<span class="ansi-green-fg">✔</span> <span class="ansi-blue-fg">tidyr  </span> 0.8.3     <span class="ansi-green-fg">✔</span> <span class="ansi-blue-fg">stringr</span> 1.4.0
<span class="ansi-green-fg">✔</span> <span class="ansi-blue-fg">readr  </span> 1.3.1     <span class="ansi-green-fg">✔</span> <span class="ansi-blue-fg">forcats</span> 0.4.0
── <span class="ansi-bold">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──
<span class="ansi-red-fg">✖</span> <span class="ansi-blue-fg">dplyr</span>::<span class="ansi-green-fg">filter()</span> masks <span class="ansi-blue-fg">stats</span>::filter()
<span class="ansi-red-fg">✖</span> <span class="ansi-blue-fg">dplyr</span>::<span class="ansi-green-fg">lag()</span>    masks <span class="ansi-blue-fg">stats</span>::lag()
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Set-random-number-seed-for-reproucibility">
<h2>Set random number seed for reproucibility<a class="headerlink" href="#Set-random-number-seed-for-reproucibility" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Functions-around-probability-distributions">
<h2>Functions around probability distributions<a class="headerlink" href="#Functions-around-probability-distributions" title="Permalink to this headline">¶</a></h2>
<p>Random numbers</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>rnorm<span class="p">(</span><span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ol class=list-inline>
    <li>1.37095844714667</li>
    <li>-0.564698171396089</li>
    <li>0.363128411337339</li>
    <li>0.63286260496104</li>
    <li>0.404268323140999</li>
</ol></div>
</div>
<p>PDF</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>x <span class="o">&lt;-</span> <span class="kp">seq</span><span class="p">(</span><span class="m">-3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> length.out <span class="o">=</span> <span class="m">100</span><span class="p">)</span>
plot<span class="p">(</span>x<span class="p">,</span> dnorm<span class="p">(</span>x<span class="p">),</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;PDF&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/janice_7_Statistical_Inference_Solutions_9_0.png" src="../_images/janice_7_Statistical_Inference_Solutions_9_0.png" />
</div>
</div>
<p>CDF</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>x <span class="o">&lt;-</span> <span class="kp">seq</span><span class="p">(</span><span class="m">-3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> length.out <span class="o">=</span> <span class="m">100</span><span class="p">)</span>
plot<span class="p">(</span>x<span class="p">,</span> pnorm<span class="p">(</span>x<span class="p">),</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;CDF&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/janice_7_Statistical_Inference_Solutions_11_0.png" src="../_images/janice_7_Statistical_Inference_Solutions_11_0.png" />
</div>
</div>
<p>Quantiles (inverse CDF)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>p <span class="o">=</span> <span class="kp">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> length.out <span class="o">=</span> <span class="m">101</span><span class="p">)</span>
plot<span class="p">(</span>p<span class="p">,</span> qnorm<span class="p">(</span>p<span class="p">),</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;Quantile&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/janice_7_Statistical_Inference_Solutions_13_0.png" src="../_images/janice_7_Statistical_Inference_Solutions_13_0.png" />
</div>
</div>
</div>
<div class="section" id="Point-estimates">
<h2>Point estimates<a class="headerlink" href="#Point-estimates" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>x <span class="o">&lt;-</span> rnorm<span class="p">(</span><span class="m">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>x
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ol class=list-inline>
    <li>-0.106124516091484</li>
    <li>1.51152199743894</li>
    <li>-0.0946590384130976</li>
    <li>2.01842371387704</li>
    <li>-0.062714099052421</li>
    <li>1.30486965422349</li>
    <li>2.28664539270111</li>
    <li>-1.38886070111234</li>
    <li>-0.278788766817371</li>
    <li>-0.133321336393658</li>
</ol></div>
</div>
<div class="section" id="Mean">
<h3>Mean<a class="headerlink" href="#Mean" title="Permalink to this headline">¶</a></h3>
<p>Manual calculation</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">sum</span><span class="p">(</span>x<span class="p">)</span><span class="o">/</span><span class="kp">length</span><span class="p">(</span>x<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
0.50569923003602</div>
</div>
<p>Using built-in function</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">mean</span><span class="p">(</span>x<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
0.50569923003602</div>
</div>
</div>
<div class="section" id="Median">
<h3>Median<a class="headerlink" href="#Median" title="Permalink to this headline">¶</a></h3>
<p>Manual calculation</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>x_sorted <span class="o">&lt;-</span> <span class="kp">sort</span><span class="p">(</span>x<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">length</span><span class="p">(</span>x<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
10</div>
</div>
<p>Since there are an even number of observations, we need the average of the middle two data poitns</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">sum</span><span class="p">(</span>x_sorted<span class="p">[</span><span class="m">5</span><span class="o">:</span><span class="m">6</span><span class="p">])</span><span class="o">/</span><span class="m">2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
-0.0786865687327593</div>
</div>
<p>Using built-in function</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>median<span class="p">(</span>x<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
-0.0786865687327593</div>
</div>
</div>
<div class="section" id="Quantiles">
<h3>Quantiles<a class="headerlink" href="#Quantiles" title="Permalink to this headline">¶</a></h3>
<p>The mean is just the <span class="math notranslate nohighlight">\(50^{th}\)</span> percentile. We can use R to get any percentile we like.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>quantile<span class="p">(</span>x<span class="p">,</span> <span class="m">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<strong>50%:</strong> -0.0786865687327593</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>quantile<span class="p">(</span>x<span class="p">,</span> <span class="kp">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span>length.out <span class="o">=</span> <span class="m">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<dl class=dl-horizontal>
    <dt>0%</dt>
            <dd>-1.38886070111234</dd>
    <dt>25%</dt>
            <dd>-0.126522131318115</dd>
    <dt>50%</dt>
            <dd>-0.0786865687327593</dd>
    <dt>75%</dt>
            <dd>1.45985891163508</dd>
    <dt>100%</dt>
            <dd>2.28664539270111</dd>
</dl></div>
</div>
<p><strong>Exercise</strong></p>
<p>Gene X is known to have a normal distribution with a mean of 100 units and a standard deviation of 15 units in the US population. With respect to this population,</p>
<ul class="simple">
<li><ol class="arabic simple">
<li><p>What is the medan value for gene X?</p></li>
</ol>
</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="m">100</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
100</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="2">
<li><p>What is the probability of finding a value of more than 130 for gene X if you pick a person at random?</p></li>
</ol>
</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>m <span class="o">&lt;-</span> <span class="m">100</span>
s <span class="o">&lt;-</span> <span class="m">15</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="m">1</span> <span class="o">-</span> pnorm<span class="p">(</span><span class="m">130</span><span class="p">,</span> m<span class="p">,</span> s<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
0.0227501319481792</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="3">
<li><p>If you measure gene X and find that it is in the 95th percentile for this population, what is the measured value?</p></li>
</ol>
</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>qnorm<span class="p">(</span><span class="m">0.95</span><span class="p">,</span> m<span class="p">,</span> s<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
124.672804404272</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="4">
<li><p>Find answers to questions (1), (2) and (3) by simulating 1 million people sampled from the US population. Do they agree with the theoretical calculated values?</p></li>
</ol>
</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>n <span class="o">&lt;-</span> <span class="m">1e6</span>
x <span class="o">&lt;-</span> rnorm<span class="p">(</span>n<span class="p">,</span> m<span class="p">,</span> s<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>median<span class="p">(</span>x<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
100.020793858963</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">sum</span><span class="p">(</span>x <span class="o">&gt;</span> <span class="m">130</span><span class="p">)</span><span class="o">/</span>n
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
0.022838</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>quantile<span class="p">(</span>x<span class="p">,</span> <span class="m">0.95</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<strong>95%:</strong> 124.695020504446</div>
</div>
<ul class="simple">
<li><ol class="arabic simple" start="5">
<li><p>Plot the PDF of gene X using <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> for values between 50 and 150. Give it a title of <code class="docutils literal notranslate"><span class="pre">PDF</span> <span class="pre">of</span> <span class="pre">N(100,</span> <span class="pre">15)</span></code>, a subtile of <code class="docutils literal notranslate"><span class="pre">I</span> <span class="pre">made</span> <span class="pre">this!</span></code>, and label the x-axis as <code class="docutils literal notranslate"><span class="pre">Gene</span> <span class="pre">X</span></code> and y-axis as <code class="docutils literal notranslate"><span class="pre">PDF</span></code>. Make the PDF blue, and fill the region under the curve blue with a transparency of 50%.</p></li>
</ol>
</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>x <span class="o">&lt;-</span> <span class="m">50</span><span class="o">:</span><span class="m">150</span>
df <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>x<span class="o">=</span>x<span class="p">,</span> y<span class="o">=</span>dnorm<span class="p">(</span>x<span class="p">,</span> m<span class="p">,</span> s<span class="p">))</span>
ggplot<span class="p">(</span>df<span class="p">,</span> aes<span class="p">(</span>x<span class="o">=</span>x<span class="p">,</span> y<span class="o">=</span>y<span class="p">))</span> <span class="o">+</span>
geom_line<span class="p">(</span>color<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span> <span class="o">+</span>
geom_polygon<span class="p">(</span>fill<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> alpha<span class="o">=</span><span class="m">0.5</span><span class="p">)</span> <span class="o">+</span>
labs<span class="p">(</span>title<span class="o">=</span><span class="s">&#39;PDF of N(100, 15)&#39;</span><span class="p">,</span>
    subtitle<span class="o">=</span><span class="s">&#39;I made this!&#39;</span><span class="p">,</span>
    x<span class="o">=</span><span class="s">&#39;Gene X&#39;</span><span class="p">,</span>
    y<span class="o">=</span><span class="s">&#39;PDF&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/janice_7_Statistical_Inference_Solutions_47_0.png" src="../_images/janice_7_Statistical_Inference_Solutions_47_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Interval-estimates">
<h2>Interval estimates<a class="headerlink" href="#Interval-estimates" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Confidence-intervals">
<h3>Confidence intervals<a class="headerlink" href="#Confidence-intervals" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>ci <span class="o">=</span> <span class="m">0.95</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>alpha <span class="o">=</span> <span class="p">(</span><span class="m">1</span><span class="o">-</span>ci<span class="p">)</span>
n <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>x<span class="p">)</span>
m <span class="o">&lt;-</span> <span class="kp">mean</span><span class="p">(</span>x<span class="p">)</span>
s <span class="o">&lt;-</span> sd<span class="p">(</span>x<span class="p">)</span>
se <span class="o">&lt;-</span> s<span class="o">/</span><span class="kp">sqrt</span><span class="p">(</span>n<span class="p">)</span>
me <span class="o">&lt;-</span> qt<span class="p">(</span><span class="m">1</span><span class="o">-</span>alpha<span class="o">/</span><span class="m">2</span><span class="p">,</span> df<span class="o">=</span>n<span class="m">-1</span><span class="p">)</span> <span class="o">*</span> se
<span class="kt">c</span><span class="p">(</span>m <span class="o">-</span> me<span class="p">,</span> m <span class="o">+</span> me<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ol class=list-inline>
    <li>94.215778757373</li>
    <li>105.784221242627</li>
</ol></div>
</div>
<p>Note that confidence intervals get larger as the confidence required increases.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>ci <span class="o">=</span> <span class="m">0.99</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>alpha <span class="o">=</span> <span class="p">(</span><span class="m">1</span><span class="o">-</span>ci<span class="p">)</span>
n <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>x<span class="p">)</span>
m <span class="o">&lt;-</span> <span class="kp">mean</span><span class="p">(</span>x<span class="p">)</span>
s <span class="o">&lt;-</span> sd<span class="p">(</span>x<span class="p">)</span>
se <span class="o">&lt;-</span> s<span class="o">/</span><span class="kp">sqrt</span><span class="p">(</span>n<span class="p">)</span>
me <span class="o">&lt;-</span> qt<span class="p">(</span><span class="m">1</span><span class="o">-</span>alpha<span class="o">/</span><span class="m">2</span><span class="p">,</span> df<span class="o">=</span>n<span class="m">-1</span><span class="p">)</span> <span class="o">*</span> se
<span class="kt">c</span><span class="p">(</span>m <span class="o">-</span> me<span class="p">,</span> m <span class="o">+</span> me<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ol class=list-inline>
    <li>92.3442793441823</li>
    <li>107.655720655818</li>
</ol></div>
</div>
</div>
<div class="section" id="Making-a-function">
<h3>Making a function<a class="headerlink" href="#Making-a-function" title="Permalink to this headline">¶</a></h3>
<div class="section" id="Review-of-R-custom-functions">
<h4>Review of R custom functions<a class="headerlink" href="#Review-of-R-custom-functions" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>f <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>a<span class="p">,</span> b<span class="o">=</span><span class="m">1</span><span class="p">)</span> <span class="p">{</span>
    a <span class="o">+</span> b
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>f<span class="p">(</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
3</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>f<span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
5</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>f<span class="p">(</span>b<span class="o">=</span><span class="m">4</span><span class="p">,</span> a<span class="o">=</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
5</div>
</div>
<p><strong>Exercise</strong></p>
<p>Make a function called <code class="docutils literal notranslate"><span class="pre">conf</span></code> for calculating confidence intervals for the sample mean that takes two arguments</p>
<ul class="simple">
<li><p>x is the vector of sample values</p></li>
<li><p>ci is the confidence interval with a default of 0.95</p></li>
</ul>
<p>The funciton should return a vector of two numbers indicating the lwoer and upper limeit of the confidence interval</p>
<p>Check that it gives the same answer as the example above.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>conf <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">,</span> ci<span class="o">=</span><span class="m">0.95</span><span class="p">)</span> <span class="p">{</span>
   alpha <span class="o">=</span> <span class="p">(</span><span class="m">1</span><span class="o">-</span>ci<span class="p">)</span>
    n <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>x<span class="p">)</span>
    m <span class="o">&lt;-</span> <span class="kp">mean</span><span class="p">(</span>x<span class="p">)</span>
    s <span class="o">&lt;-</span> sd<span class="p">(</span>x<span class="p">)</span>
    se <span class="o">&lt;-</span> s<span class="o">/</span><span class="kp">sqrt</span><span class="p">(</span>n<span class="p">)</span>
    me <span class="o">&lt;-</span> qt<span class="p">(</span><span class="m">1</span><span class="o">-</span>alpha<span class="o">/</span><span class="m">2</span><span class="p">,</span> df<span class="o">=</span>n<span class="m">-1</span><span class="p">)</span> <span class="o">*</span> se
    <span class="kt">c</span><span class="p">(</span>m <span class="o">-</span> me<span class="p">,</span> m <span class="o">+</span> me<span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>conf<span class="p">(</span>x<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ol class=list-inline>
    <li>94.215778757373</li>
    <li>105.784221242627</li>
</ol></div>
</div>
</div>
</div>
<div class="section" id="Coverage">
<h3>Coverage<a class="headerlink" href="#Coverage" title="Permalink to this headline">¶</a></h3>
<p>In 1,000 experiments, we expect the true mean (0) to lie within the estimated 95% CIs 950 times.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>n_expt <span class="o">&lt;-</span> <span class="m">1000</span>
n <span class="o">&lt;-</span> <span class="m">10</span>
cls <span class="o">&lt;-</span> <span class="kp">t</span><span class="p">(</span><span class="kp">replicate</span><span class="p">(</span>n_expt<span class="p">,</span> conf<span class="p">(</span>rnorm<span class="p">(</span>n<span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">sum</span><span class="p">(</span>cls<span class="p">[,</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="m">0</span> <span class="o">&amp;</span> <span class="m">0</span> <span class="o">&lt;</span> cls<span class="p">[,</span><span class="m">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
960</div>
</div>
</div>
</div>
<div class="section" id="Hypothesis-testing">
<h2>Hypothesis testing<a class="headerlink" href="#Hypothesis-testing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Binomial-test">
<h3>Binomial test<a class="headerlink" href="#Binomial-test" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>

n <span class="o">=</span> <span class="m">50</span>
tosses <span class="o">=</span> <span class="kp">sample</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="s">&#39;T&#39;</span><span class="p">),</span> n<span class="p">,</span> replace<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> prob<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0.55</span><span class="p">,</span> <span class="m">0.45</span><span class="p">))</span>
t <span class="o">=</span> <span class="kp">table</span><span class="p">(</span>tosses<span class="p">)</span>
<span class="kp">t</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>tosses
 H  T
27 23
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>binom.test<span class="p">(</span><span class="kp">table</span><span class="p">(</span>tosses<span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>    Exact binomial test

data:  table(tosses)
number of successes = 27, number of trials = 50, p-value = 0.6718
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.3932420 0.6818508
sample estimates:
probability of success
                  0.54

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>

n <span class="o">=</span> <span class="m">250</span>
tosses <span class="o">=</span> <span class="kp">sample</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="s">&#39;T&#39;</span><span class="p">),</span> n<span class="p">,</span> replace<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> prob<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0.55</span><span class="p">,</span> <span class="m">0.45</span><span class="p">))</span>
t <span class="o">=</span> <span class="kp">table</span><span class="p">(</span>tosses<span class="p">)</span>
<span class="kp">t</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>tosses
  H   T
139 111
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>binom.test<span class="p">(</span><span class="kp">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>    Exact binomial test

data:  t
number of successes = 139, number of trials = 250, p-value = 0.0875
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.4920569 0.6185995
sample estimates:
probability of success
                 0.556

</pre></div>
</div>
</div>
<div class="section" id="What-happens-if-we-choose-a-one-sided-test?">
<h4>What happens if we choose a one-sided test?<a class="headerlink" href="#What-happens-if-we-choose-a-one-sided-test?" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>binom.test<span class="p">(</span><span class="kp">t</span><span class="p">,</span> alternative <span class="o">=</span> <span class="s">&quot;greater&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>    Exact binomial test

data:  t
number of successes = 139, number of trials = 250, p-value = 0.04375
alternative hypothesis: true probability of success is greater than 0.5
95 percent confidence interval:
 0.5020197 1.0000000
sample estimates:
probability of success
                 0.556

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>binom.test<span class="p">(</span><span class="kp">t</span><span class="p">,</span> alternative <span class="o">=</span> <span class="s">&quot;less&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>    Exact binomial test

data:  t
number of successes = 139, number of trials = 250, p-value = 0.9668
alternative hypothesis: true probability of success is less than 0.5
95 percent confidence interval:
 0.0000000 0.6089811
sample estimates:
probability of success
                 0.556

</pre></div>
</div>
</div>
</div>
<div class="section" id="What-happens-if-we-change-our-null-hypothesis?">
<h4>What happens if we change our null hypothesis?<a class="headerlink" href="#What-happens-if-we-change-our-null-hypothesis?" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>binom.test<span class="p">(</span><span class="kp">t</span><span class="p">,</span> p <span class="o">=</span> <span class="m">0.55</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>    Exact binomial test

data:  t
number of successes = 139, number of trials = 250, p-value = 0.8989
alternative hypothesis: true probability of success is not equal to 0.55
95 percent confidence interval:
 0.4920569 0.6185995
sample estimates:
probability of success
                 0.556

</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="Two-sample-model">
<h2>Two-sample model<a class="headerlink" href="#Two-sample-model" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Welch-t-test">
<h3>Welch t-test<a class="headerlink" href="#Welch-t-test" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>

n <span class="o">&lt;-</span> <span class="m">10</span>
x1 <span class="o">&lt;-</span> rnorm<span class="p">(</span>n<span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
x2 <span class="o">&lt;-</span> rnorm<span class="p">(</span>n<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>t.test<span class="p">(</span>x1<span class="p">,</span> x2<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>    Welch Two Sample t-test

data:  x1 and x2
t = -2.5438, df = 17.872, p-value = 0.02044
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.0710488 -0.1969438
sample estimates:
 mean of x  mean of y
0.07462564 1.20862196

</pre></div>
</div>
</div>
</div>
<div class="section" id="Standard-t-test">
<h3>Standard t-test<a class="headerlink" href="#Standard-t-test" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>t.test<span class="p">(</span>x1<span class="p">,</span> x2<span class="p">,</span> var.equal <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>    Two Sample t-test

data:  x1 and x2
t = -2.5438, df = 18, p-value = 0.02036
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.0705694 -0.1974232
sample estimates:
 mean of x  mean of y
0.07462564 1.20862196

</pre></div>
</div>
</div>
</div>
<div class="section" id="Power-of-t-test">
<h3>Power of t-test<a class="headerlink" href="#Power-of-t-test" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>d <span class="o">&lt;-</span> <span class="m">1</span> <span class="c1"># Effect size is ratio of difference in means to standard deviation</span>
</pre></div>
</div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>pwr<span class="p">)</span>
pwr.t.test<span class="p">(</span>d <span class="o">=</span> d<span class="p">,</span> sig.level <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span> power <span class="o">=</span> <span class="m">0.9</span><span class="p">)</span>
</pre></div>
</div>
<p>gives output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="n">Two</span><span class="o">-</span><span class="n">sample</span> <span class="n">t</span> <span class="n">test</span> <span class="n">power</span> <span class="n">calculation</span>

              <span class="n">n</span> <span class="o">=</span> <span class="mf">22.02109</span>
              <span class="n">d</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">sig</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="mf">0.05</span>
          <span class="n">power</span> <span class="o">=</span> <span class="mf">0.9</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="n">two</span><span class="o">.</span><span class="n">sided</span>

<span class="n">NOTE</span><span class="p">:</span> <span class="n">n</span> <span class="ow">is</span> <span class="n">number</span> <span class="ow">in</span> <span class="o">*</span><span class="n">each</span><span class="o">*</span> <span class="n">group</span>
</pre></div>
</div>
<div class="section" id="Interpretation-of-the-power-calculaiton">
<h4>Interpretation of the power calculaiton<a class="headerlink" href="#Interpretation-of-the-power-calculaiton" title="Permalink to this headline">¶</a></h4>
<p>If we did many experiments with <code class="docutils literal notranslate"><span class="pre">n=23</span></code> per group where the effect size is as specified and the test assumptions are valid, we expect that at least 90% of them will have a p-value less than the nominal significance level (0.05). If we used <code class="docutils literal notranslate"><span class="pre">n=22</span></code> we would expect that just under 90% of the experiments will have a p-value less than the nomial significance level (0.05).</p>
<p>In particular notet that about 1-power of the experiments will fail to show a statistically significant p value even if the assumptionss are met (false negative).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>n_expts <span class="o">&lt;-</span> <span class="m">10000</span>
n <span class="o">&lt;-</span> <span class="m">22</span>
alpha <span class="o">=</span> <span class="m">0.05</span>
<span class="kp">sum</span><span class="p">(</span><span class="kp">replicate</span><span class="p">(</span>n_expts<span class="p">,</span> t.test<span class="p">(</span>rnorm<span class="p">(</span>n<span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> rnorm<span class="p">(</span>n<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span><span class="o">$</span>p.value<span class="p">)</span> <span class="o">&lt;</span> alpha<span class="p">)</span><span class="o">/</span>n_expts
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
0.901</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>n_expts <span class="o">&lt;-</span> <span class="m">10000</span>
n <span class="o">&lt;-</span> <span class="m">23</span>
alpha <span class="o">=</span> <span class="m">0.05</span>
<span class="kp">sum</span><span class="p">(</span><span class="kp">replicate</span><span class="p">(</span>n_expts<span class="p">,</span> t.test<span class="p">(</span>rnorm<span class="p">(</span>n<span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> rnorm<span class="p">(</span>n<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span><span class="o">$</span>p.value<span class="p">)</span> <span class="o">&lt;</span> alpha<span class="p">)</span><span class="o">/</span>n_expts
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
0.9125</div>
</div>
</div>
<div class="section" id="Distribution-of-p-values-under-the-null-is-uniform">
<h4>Distribution of p-values under the null is uniform<a class="headerlink" href="#Distribution-of-p-values-under-the-null-is-uniform" title="Permalink to this headline">¶</a></h4>
<p>That meas that you expect <span class="math notranslate nohighlight">\(\alpha\)</span> of the experiments to be false positives.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>n_expt <span class="o">&lt;-</span> <span class="m">10000</span>
n <span class="o">&lt;-</span> <span class="m">50</span>
ps <span class="o">&lt;-</span> <span class="kp">replicate</span><span class="p">(</span>n_expts<span class="p">,</span> t.test<span class="p">(</span>rnorm<span class="p">(</span>n<span class="p">),</span> rnorm<span class="p">(</span>n<span class="p">))</span><span class="o">$</span>p.value<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="kp">sum</span><span class="p">(</span>ps <span class="o">&lt;</span> alpha<span class="p">)</span><span class="o">/</span>n_expts
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
0.0478</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>hist<span class="p">(</span>ps<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/janice_7_Statistical_Inference_Solutions_93_0.png" src="../_images/janice_7_Statistical_Inference_Solutions_93_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Paired-and-one-sample-t-tests">
<h3>Paired and one-sample t-tests<a class="headerlink" href="#Paired-and-one-sample-t-tests" title="Permalink to this headline">¶</a></h3>
<p>A paired t-test is commonly used to evaluate if paired measuremetns (e..g. weight before and after a diet for the same person) has changed. The paired t-test is equivalent to a one-sample t-test that compares the difference in measurements for the paired values with a fixed number (usually 0).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>x1 <span class="o">&lt;-</span> rnorm<span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="m">15</span><span class="p">)</span>
x2 <span class="o">&lt;-</span> rnorm<span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="m">15</span><span class="p">)</span>
delta <span class="o">&lt;-</span> x1 <span class="o">-</span> x2
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>t.test<span class="p">(</span>x1<span class="p">,</span> x2<span class="p">,</span> paired<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>    Paired t-test

data:  x1 and x2
t = -2.4618, df = 9, p-value = 0.03605
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -12.3446069  -0.5215923
sample estimates:
mean of the differences
                -6.4331

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>t.test<span class="p">(</span>delta<span class="p">,</span> mu<span class="o">=</span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>

<span></span>    One Sample t-test

data:  delta
t = -2.4618, df = 9, p-value = 0.03605
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -12.3446069  -0.5215923
sample estimates:
mean of x
  -6.4331

</pre></div>
</div>
</div>
<p><strong>Exercise</strong></p>
<p>Suppose that the null hypotehsis is that there is no difference in the paired measurements and the standard deviation of the differene is 2.</p>
<ul class="simple">
<li><p>Run a simulation for 100,000 experiments with <code class="docutils literal notranslate"><span class="pre">n=25</span></code> per experiment to show the distributon of the p values using a paired or one -sample t-test under the null.</p></li>
<li><p>If the significance level is 0.05, how many false positive results were observed?</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>n_expt <span class="o">&lt;-</span> <span class="m">100000</span>
n <span class="o">&lt;-</span> <span class="m">25</span>
s <span class="o">&lt;-</span> <span class="m">2</span>
ps <span class="o">&lt;-</span> <span class="kp">replicate</span><span class="p">(</span>n_expts<span class="p">,</span> t.test<span class="p">(</span>rnorm<span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> s<span class="p">),</span> mu<span class="o">=</span><span class="m">0</span><span class="p">)</span><span class="o">$</span>p.value<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>hist<span class="p">(</span>ps<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/janice_7_Statistical_Inference_Solutions_100_0.png" src="../_images/janice_7_Statistical_Inference_Solutions_100_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span>n <span class="o">&lt;-</span> <span class="m">100000</span>
s <span class="o">&lt;-</span> <span class="kp">sqrt</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
sd<span class="p">(</span>rnorm<span class="p">(</span>n<span class="p">,</span> <span class="m">0</span><span class="p">,</span> s<span class="p">)</span> <span class="o">-</span> rnorm<span class="p">(</span>n<span class="p">,</span> <span class="m">0</span><span class="p">,</span> s<span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
2.00293039283011</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../cliburn/Unix01_File_And_Directory_Solutions.html" class="btn btn-neutral float-right" title="Working with Unix" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="6_Statistical_Inference.html" class="btn btn-neutral float-left" title="Simulations and Statistical Inference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>